(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{236:function(e,t,o){e.exports=o(453)},429:function(e,t,o){},441:function(e,t,o){},448:function(e,t,o){},449:function(e,t,o){},453:function(e,t,o){"use strict";o.r(t);o(237),o(239);var n=o(0),a=o.n(n),r=o(49),i=o.n(r),c=o(24),s=o(171),l=o(39),u=o(19),p=o(6),d=o(30),v=o(132),m=o.n(v),h=o(54),f={activeStory:null,activeView:null,activePanel:null,storiesHistory:[],viewsHistory:[],panelsHistory:[],activeModals:[],modalHistory:[],popouts:[],scrollPosition:[]},b={accessToken:void 0,colorScheme:"client_light"},g={forms:[]},y={activeCounter:0,counters:[],lastId:0,loadedCounters:!1},C=Object(c.combineReducers)({vkui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_COLOR_SCHEME":return Object(p.a)({},e,{colorScheme:t.payload});case"SET_ACCESS_TOKEN":return Object(p.a)({},e,{accessToken:t.payload});default:return e}},router:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PAGE":var o=t.payload.view,n=t.payload.panel;window.history.pushState(null,null);var a=e.panelsHistory[o]||[],r=e.viewsHistory[e.activeStory]||[],i=r.indexOf(o);return-1!==i&&r.splice(i,1),-1===a.indexOf(n)&&(a=[].concat(Object(d.a)(a),[n])),a.length>1&&h.a.send("VKWebAppEnableSwipeBack",{}),Object(p.a)({},e,{activeView:o,activePanel:n,panelsHistory:Object(p.a)({},e.panelsHistory,Object(u.a)({},o,a)),viewsHistory:Object(p.a)({},e.viewsHistory,Object(u.a)({},e.activeStory,[].concat(Object(d.a)(r),[o]))),scrollPosition:Object(p.a)({},e.scrollPosition,Object(u.a)({},e.activeStory+"_"+e.activeView+"_"+e.activePanel,window.pageYOffset))});case"SET_STORY":window.history.pushState(null,null);var c=e.viewsHistory[t.payload.story]||[t.payload.story],s=e.storiesHistory,l=c[c.length-1],v=e.panelsHistory[l]||[t.payload.initial_panel],m=v[v.length-1];if(t.payload.story===e.activeStory)if(v.length>1){var b=v.shift();m=(v=[b])[v.length-1]}else if(c.length>1){var g=c.shift();l=(c=[g])[c.length-1],m=(v=e.panelsHistory[l])[v.length-1]}t.payload.story===e.activeStory&&1===v.length&&window.pageYOffset>0&&(window.scrollTo(0,30),function e(){var t=document.documentElement.scrollTop||document.body.scrollTop;t>30||t>0&&(window.requestAnimationFrame(e),window.scrollTo(0,t-t/8))}());var y=s.indexOf(t.payload.story);return-1!==y&&0!==y&&s.splice(y,1),Object(p.a)({},e,{activeStory:t.payload.story,activeView:l,activePanel:m,storiesHistory:[].concat(Object(d.a)(s),[t.payload.story]),viewsHistory:Object(p.a)({},e.viewsHistory,Object(u.a)({},l,c)),panelsHistory:Object(p.a)({},e.panelsHistory,Object(u.a)({},l,v)),scrollPosition:Object(p.a)({},e.scrollPosition,Object(u.a)({},e.activeStory+"_"+e.activeView+"_"+e.activePanel,window.pageYOffset))});case"GO_BACK":var C=e.activeView,O=e.activePanel,E=e.activeStory,j=e.popouts;if(j[C])return j[C]=null,Object(p.a)({},e,{popouts:Object(p.a)({},e.popouts,{popoutsData:j})});var w=e.modalHistory[C];if(void 0!==w&&0!==w.length){var S=w[w.length-2]||null;return null===S?w=[]:-1!==w.indexOf(S)?w=w.splice(0,w.indexOf(S)+1):w.push(S),Object(p.a)({},e,{activeModals:Object(p.a)({},e.activeModals,Object(u.a)({},C,S)),modalHistory:Object(p.a)({},e.modalHistory,Object(u.a)({},C,w))})}var k=e.panelsHistory[C]||[],T=e.viewsHistory[e.activeStory]||[],P=e.storiesHistory;if(k.length>1)k.pop(),O=k[k.length-1];else if(T.length>1){T.pop(),C=T[T.length-1];var A=e.panelsHistory[C];O=A[A.length-1]}else if(P.length>1&&"Android"===t.payload.from){P.pop(),E=P[P.length-1],C=e.viewsHistory[E][e.viewsHistory[E].length-1];var V=e.panelsHistory[C];O=V.length>1?V[V.length-1]:V[0]}else h.a.send("VKWebAppClose",{status:"success"});return 1===k.length&&"iOS"===t.payload.from&&h.a.send("VKWebAppDisableSwipeBack",{}),Object(p.a)({},e,{activeView:C,activePanel:O,activeStory:E,viewsHistory:Object(p.a)({},e.viewsHistory,Object(u.a)({},e.activeView,T)),panelsHistory:Object(p.a)({},e.panelsHistory,Object(u.a)({},e.activeView,k))});case"OPEN_POPOUT":return window.history.pushState(null,null),Object(p.a)({},e,{popouts:Object(p.a)({},e.popouts,Object(u.a)({},e.activeView,t.payload.popout))});case"CLOSE_POPOUT":return Object(p.a)({},e,{popouts:Object(p.a)({},e.popouts,Object(u.a)({},e.activeView,null))});case"OPEN_MODAL":window.history.pushState(null,null);var N=t.payload.id||null,_=t.payload.modalProps||{},I=e.modalHistory[e.activeView]?Object(d.a)(e.modalHistory[e.activeView]):[];return null===N?I=[]:-1!==I.indexOf(N)?I=I.splice(0,I.indexOf(N)+1):I.push(N),Object(p.a)({},e,{activeModals:Object(p.a)({},e.activeModals,Object(u.a)({},e.activeView,N)),modalHistory:Object(p.a)({},e.modalHistory,Object(u.a)({},e.activeView,I)),activeModalProps:_});case"CLOSE_MODAL":var M=e.modalHistory[e.activeView][e.modalHistory[e.activeView].length-2]||null,H=e.modalHistory[e.activeView]?Object(d.a)(e.modalHistory[e.activeView]):[];return null===M?H=[]:-1!==H.indexOf(M)?H=H.splice(0,H.indexOf(M)+1):H.push(M),Object(p.a)({},e,{activeModals:Object(p.a)({},e.activeModals,Object(u.a)({},e.activeView,M)),modalHistory:Object(p.a)({},e.modalHistory,Object(u.a)({},e.activeView,H))});default:return e}},formData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SAVE_FORM_DATA":return Object(p.a)({},e,{forms:Object(p.a)({},e.forms,Object(u.a)({},t.payload.form,t.payload.data))});default:return e}},counter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0,o=function(){switch(t.type){case"CREATE_COUNTER":for(var o=t.payload.name||"\u041d\u043e\u0432\u044b\u0439 \u0441\u0447\u0435\u0442\u0447\u0438\u043a";;){var n=!0;if(e.counters.forEach(function(e){if(console.log(o,e.name),e.name===o){console.log("is queal");var t=(o=e.name).match(/\(([0-9]+)\)$/)||[],a=Number(t[1]);console.log(a),a?(a+=1,o=o.replace(/\(([0-9]+)\)$/,"("+a+")")):o+=" (1)",n=!1}}),n)break}var a=[].concat(Object(d.a)(e.counters),[Object(p.a)({},t.payload,{name:o})]);return console.log("[Storage] create counter ",a),localStorage.setItem("counters",JSON.stringify(a||[])),{v:Object(p.a)({},e,{counters:a})};case"CHANGE_VALUE":return(a=Object(d.a)(e.counters))[t.payload.id].value=t.payload.val,localStorage.setItem("counters",JSON.stringify(a||[])),{v:Object(p.a)({},e,{counters:a})};case"SET_ACTIVE_COUNTER":case"SET_COUNTERS":case"SET_LOADED_COUNTERS":return t.payload.counters&&localStorage.setItem("counters",JSON.stringify(t.payload.counters||[])),{v:Object(p.a)({},e,t.payload)};default:return{v:e}}}();if("object"===typeof o)return o.v}}),O=o(173),E=o(174),j=o.n(E),w=function(e,t){return{type:"SET_STORY",payload:{story:e,initial_panel:t}}},S=function(){return{type:"GO_BACK",payload:{from:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"iOS"}}},k=function(e){return{type:"OPEN_POPOUT",payload:{popout:e}}},T=function(){return{type:"CLOSE_POPOUT"}},P=function(e){return{type:"OPEN_MODAL",payload:{id:e,modalProps:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}}}},A=function(){return{type:"CLOSE_MODAL"}},V=(o(428),o(429),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function N(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var _=o(133),I=o.n(_),M=o(175),H=o(36),D=o(37),L=o(40),x=o(38),U=o(41),R=function(){return{type:"CREATE_COUNTER",payload:{name:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u041d\u043e\u0432\u044b\u0439 \u0441\u0447\u0435\u0442\u0447\u0438\u043a",value:arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,resetValue:arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,id:arguments.length>3&&void 0!==arguments[3]?arguments[3]:0}}},B=function(){return{type:"SET_COUNTERS",payload:{counters:arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]}}},W=function(){return{type:"SET_ACTIVE_COUNTER",payload:{activeCounter:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0}}},G=function(){return{type:"SET_LAST_ID",payload:{lastId:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0}}},K=function(){return{type:"CHANGE_VALUE",payload:{id:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,val:arguments.length>1&&void 0!==arguments[1]?arguments[1]:1}}},J=function(){return{type:"SET_LOADED_COUNTERS",payload:{loadedCounters:arguments.length>0&&void 0!==arguments[0]&&arguments[0]}}},q=o(5),z=(o(441),function(e){function t(){return Object(H.a)(this,t),Object(L.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(U.a)(t,e),Object(D.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"outline-message"},this.props.text)}}]),t}(a.a.Component)),Y=o(129),$=o.n(Y),F=o(93),Q=o.n(F),X=(o(128),o(79)),Z=o.n(X),ee=o(74),te=o.n(ee),oe=o(94),ne=o.n(oe),ae=function(e){function t(e){var o;return Object(H.a)(this,t),(o=Object(L.a)(this,Object(x.a)(t).call(this,e))).deleteAllCounts=function(){var e=o.props.counters.length;localStorage.clear(),o.props.setActiveCounter(0),o.props.setCounters([]),o.props.setLastId(-1),o.alertMessage(e>1?"\u0412\u0441\u0435 \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u044b!":"\u0421\u0447\u0435\u0442\u0447\u0438\u043a \u0443\u0434\u0430\u043b\u0435\u043d!"),o.setState({draggable:!1,removable:!1})},o.state={draggable:!1,removable:!1},o.countTries=0,o}return Object(U.a)(t,e),Object(D.a)(t,[{key:"deleteCounter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=Object(d.a)(this.props.counters);t.splice(e,1),this.props.activeCounter===e&&this.props.setActiveCounter(0),0===t.length&&this.setState({draggable:!1,removable:!1}),this.props.setCounters(t)}},{key:"confirmDeleteCounter",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.props.openPopout(a.a.createElement(q.a,{actions:[{title:"\u041d\u0435\u0442",autoclose:!0,style:q.k?"cancel":""},{title:"\u0414\u0430",autoclose:!0,style:q.k?"":"destructive",action:function(){e.deleteCounter(t)}}],onClose:function(){return e.props.closePopout()}},"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u043e\u0442 \u0441\u0447\u0435\u0442\u0447\u0438\u043a?"))}},{key:"alertMessage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\u041e\u043a";this.props.openPopout(a.a.createElement(q.a,{actions:[{title:o,autoclose:!0}],onClose:function(){return e.props.closePopout()}},t))}},{key:"confirmDeleteCounters",value:function(){var e=this;this.props.openPopout(a.a.createElement(q.a,{actions:[{title:q.k?"\u041e\u0442\u043c\u0435\u043d\u0430":"\u041d\u0435\u0442",autoclose:!0,style:q.k?"cancel":""},{title:"\u0414\u0430",autoclose:!0,action:this.deleteAllCounts,style:q.k?"":"destructive"}],onClose:function(){return e.props.closePopout()}},"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c ",this.props.counters.length>1?"\u0432\u0441\u0435 \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u0438":"\u0441\u0447\u0435\u0442\u0447\u0438\u043a","?"))}},{key:"render",value:function(){var e=this,t=this.props,o=t.setCounters,n=t.setActiveCounter,r=t.setStory,i=(t.activeCounter,t.openModal);return a.a.createElement(q.q,{theme:"white",id:this.props.id},a.a.createElement(q.r,{left:a.a.createElement(q.j,null,a.a.createElement($.a,{onClick:function(){e.setState({draggable:!1}),i("MODAL_PAGE_MANAGE_COUNTER")}}))},"\u0412\u0430\u0448\u0438 \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u0438"),this.props.counters.length?null:a.a.createElement(z,{text:"\u0423 \u0412\u0430\u0441 \u043f\u043e\u043a\u0430 \u0447\u0442\u043e \u043d\u0435\u0442 \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u043e\u0432"}),this.props.counters.length?a.a.createElement("div",{className:"margins-top"},a.a.createElement(q.h,{vertical:"top"},a.a.createElement("div",{style:{display:"flex"},className:"controls"},this.props.counters.length>1?a.a.createElement("div",{style:{flex:10}},this.state.removable?a.a.createElement(q.b,{onClick:function(){e.countTries+=1,e.countTries>=10?(e.countTries=0,e.alertMessage("\u0421 \u0432\u0430\u043c\u0438 \u0432\u0441\u0435 \u0445\u043e\u0440\u043e\u0448\u043e?","\u0414\u0430")):e.confirmDeleteCounters()},level:"tertiary",before:a.a.createElement(te.a,null)},"\u0412\u0441\u0435"):a.a.createElement(q.b,{className:"default-button-tertiary button-full-width",before:this.state.draggable?a.a.createElement(ne.a,null):a.a.createElement(Q.a,null),level:(this.state.draggable,"tertiary"),onClick:function(){e.setState({draggable:!e.state.draggable})}},this.state.draggable?"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f":"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u0440\u044f\u0434\u043e\u043a")):null,a.a.createElement("div",null,this.state.draggable?null:a.a.createElement(q.b,{className:"destructive-button-tertiary button-full-width full-widthi-right",level:"tertiary",before:this.props.counters.length<=1&&!this.state.removable?a.a.createElement(te.a,null):null,onClick:function(){if(e.props.counters.length<=1&&!e.state.removable)return e.confirmDeleteCounters();e.setState({removable:!e.state.removable})}},this.state.removable?"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435":this.props.counters.length>1?a.a.createElement(te.a,null):"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0447\u0435\u0442\u0447\u0438\u043a")))),a.a.createElement("div",{className:"fixed-content"},a.a.createElement(q.m,null,this.props.counters.map(function(t,i){return a.a.createElement(q.c,{key:"counter"+i,onClick:function(){n(i),r("main","activeCounter")},description:String(t.value),after:t.value,removable:e.state.removable,onRemove:function(){q.k?e.deleteCounter(i):e.confirmDeleteCounter(i)},draggable:e.state.draggable,onDragFinish:function(t){var a=t.from,r=t.to,i=Object(d.a)(e.props.counters),c=i[e.props.activeCounter];i.splice(a,1),i.splice(r,0,e.props.counters[a]),n(i.indexOf(c)),o(i)},className:"counter-cell"},t.name)})))):null)}}]),t}(a.a.Component);var re=Object(l.b)(function(e){return{counters:e.counter.counters,activeCounter:e.counter.activeCounter}},function(e){return Object(p.a)({dispatch:e},Object(c.bindActionCreators)({createCounter:R,setCounters:B,setActiveCounter:W,setStory:w,openModal:P,setLastId:G,openPopout:k,closePopout:T},e))})(ae),ie=o(179),ce=o.n(ie),se=o(180),le=o(181),ue=o.n(le),pe=o(182),de=o.n(pe),ve=o(183),me=new(o.n(ve).a),he=function(e){function t(e){var o;return Object(H.a)(this,t),(o=Object(L.a)(this,Object(x.a)(t).call(this,e))).incrementCounter=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;me.enable();var t=new Number(o.state.activeCounterVal)||0,n=o.props.activeCounterObj,a=!1;if((t+=new Number(e))>999999999999&&(t=999999999999),n.resetValue<=t&&n.resetValue&&(a=!0,t=0,o.decrements=!1,o.updateCounterValue(t)),!o.decrements||a)return o.updateCounterValue(t)},o.incPositive=function(e){return o.incrementCounter(1)},o.incNegative=function(e){return o.incrementCounter(-1)},o.openEditModal=function(){o.props.openModal("MODAL_PAGE_MANAGE_COUNTER",Object(p.a)({},o.props.activeCounterObj,{onClose:function(){o.onCloseEditModal()}}))},o.incStart=function(e){e.originalEvent.preventDefault(),o.incTimeout||(o.incTimeout=setTimeout(function(){o.incInterval=setInterval(function(){o.incPositive()},50)},200))},o.decStart=function(e){e.originalEvent.preventDefault(),o.decTimeout||(o.decTimeout=setTimeout(function(){o.decInterval=setInterval(function(){o.incNegative()},50)},200))},o.onStopTouch=function(){clearTimeout(o.incTimeout),clearTimeout(o.decTimeout),clearInterval(o.incInterval),clearInterval(o.decInterval),o.incTimeout?(o.incTimeout=0,o.incPositive()):o.decTimeout&&(o.decTimeout=0,o.incNegative())},o.copyCounterValue=function(){},o.decrements=0,o.state={activeCounterVal:0},o.incTimeout=0,o.incInterval=0,o.decTimeout=0,o.decInterval=0,o}return Object(U.a)(t,e),Object(D.a)(t,[{key:"componentDidMount",value:function(){console.log("Component did mount (active counter)"),Object.keys(this.props.activeCounterObj).length?this.setState({activeCounterVal:this.props.activeCounterObj.value||0}):this.props.loadedCounters&&(this.props.createCounter("\u041d\u043e\u0432\u044b\u0439 \u0441\u0447\u0435\u0442\u0447\u0438\u043a",0),this.props.setActiveCounter(0))}},{key:"componentDidUpdate",value:function(e){this.props.activeCounterObj.value!==e.activeCounterObj.value&&(console.log("Update active counter value"),this.setState({activeCounterVal:this.props.activeCounterObj.value||0}))}},{key:"onCloseEditModal",value:function(){this.setState({activeCounterVal:this.props.store.getState().counter.counters[this.props.activeCounter].value})}},{key:"updateCounterValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e>=0&&(this.setState({activeCounterVal:e}),this.props.changeValueCounter(this.props.activeCounter,e))}},{key:"render",value:function(){var e=this.state.activeCounterVal;console.log("[Render] Rednering active counter...");var t=String(e).length,o=ce()("big-value",{"big-value-small":4===t,"middle-size":t>4&&t<6,"middle-small-size":t>=6&&t<8,"small-size":t>=8});return a.a.createElement(q.q,{theme:"white",id:this.props.id,className:"active-counter--wrap"},a.a.createElement(q.r,{left:a.a.createElement(q.j,{onClick:this.openEditModal},a.a.createElement(ue.a,null))},this.props.activeCounterObj.name),a.a.createElement(q.h,{className:"paddings"},a.a.createElement(se.CopyToClipboard,{text:this.state.activeCounterVal},a.a.createElement(q.b,{before:a.a.createElement(de.a,null),className:"icon-button"},"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c"))),a.a.createElement("div",{className:"active-counter"},a.a.createElement(q.f,{className:"justify-center active-counter--value"},a.a.createElement("span",{className:o,onTouchEnd:this.incPositive},e)),a.a.createElement(q.f,{className:"active-counter-controllers"},a.a.createElement(q.v,{className:"Touch",onMove:this.touchMove,onStart:this.incStart,onEnd:this.onStopTouch,useCapture:!0},a.a.createElement(q.b,{stopPropogation:!1,size:"xl",level:"secondary"},"+")),a.a.createElement(q.v,{className:"Touch",onMove:this.touchMove,onStart:this.decStart,onEnd:this.onStopTouch,useCapture:!0},a.a.createElement(q.b,{stretched:!0,stopPropogation:!1,size:"xl",level:"secondary",className:"minus"},"-")))))}}]),t}(a.a.PureComponent);var fe=Object(l.b)(function(e){return{activeCounterObj:e.counter.counters[e.counter.activeCounter]||{},activeCounter:e.counter.activeCounter,name:(e.counter.counters[e.counter.activeCounter]||{}).name||"",loadedCounters:e.counter.loadedCounters}},function(e){return Object(p.a)({dispatch:e},Object(c.bindActionCreators)({createCounter:R,changeValueCounter:K,openModal:P,setActiveCounter:W},e))})(he),be=o(184),ge=o.n(be),ye=(o(448),function(e){function t(e){var o;return Object(H.a)(this,t),(o=Object(L.a)(this,Object(x.a)(t).call(this,e))).deleteAllCounts=function(){localStorage.clear(),o.props.setActiveCounter(0),o.props.setCounters([]),o.alertMessage("\u0412\u0441\u0435 \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u044b!")},o.state={draggable:!1},o.countTries=0,o}return Object(U.a)(t,e),Object(D.a)(t,[{key:"alertMessage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\u041e\u043a";this.props.openPopout(a.a.createElement(q.a,{actions:[{title:o,autoclose:!0}],onClose:function(){return e.props.closePopout()}},t))}},{key:"confirmDeleteCounters",value:function(){var e=this;this.props.openPopout(a.a.createElement(q.a,{actions:[{title:q.k?"\u041e\u0442\u043c\u0435\u043d\u0430":"\u041d\u0435\u0442",autoclose:!0,style:q.k?"cancel":"destructive"},{title:"\u0414\u0430",autoclose:!0,action:this.deleteAllCounts}],onClose:function(){return e.props.closePopout()}},"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u0438?"))}},{key:"render",value:function(){var e=this,t=this.props,o=(t.setCounters,t.setStory,t.openModal,t.setActiveCounter,t.counters);return a.a.createElement(q.q,{id:this.props.id},a.a.createElement(q.r,null,"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435"),a.a.createElement("div",null,a.a.createElement(q.d,{before:a.a.createElement(ge.a,null),onClick:function(){return h.a.send("VKWebAppShare",{link:"https://vk.com/app"+String(7075707)})}},"\u0420\u0430\u0441\u0441\u043a\u0430\u0437\u0430\u0442\u044c \u043e \u0441\u0435\u0440\u0432\u0438\u0441\u0435"),a.a.createElement(q.d,{level:"danger",indicator:o.length,before:a.a.createElement(te.a,null),onClick:function(){e.countTries+=1,console.log(e.countTries),e.countTries>=10?(e.countTries=0,e.alertMessage("\u0421 \u0432\u0430\u043c\u0438 \u0432\u0441\u0435 \u0445\u043e\u0440\u043e\u0448\u043e?","\u0414\u0430")):e.confirmDeleteCounters()}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u0438")),a.a.createElement(z,{text:a.a.createElement("span",{className:"description"},"\u0412\u0435\u0440\u0441\u0438\u044f ",this.props.version)}))}}]),t}(a.a.Component));var Ce=Object(l.b)(function(e){return{counters:e.counter.counters,activeCounter:e.counter.activeCounter}},function(e){return Object(p.a)({dispatch:e},Object(c.bindActionCreators)({setCounters:B,openModal:P,setActiveCounter:W,openPopout:k,closePopout:T},e))})(ye),Oe=(o(449),function(e){function t(e){var o;return Object(H.a)(this,t),(o=Object(L.a)(this,Object(x.a)(t).call(this,e))).handleInput=function(e){var t=e.currentTarget.value;"checkbox"===e.currentTarget.type&&(t=e.currentTarget.checked),t=o.filterInputValue(e.currentTarget.name,t),o.setState({inputData:Object(p.a)({},o.state.inputData,Object(u.a)({},e.currentTarget.name,t))})},o.createCounter=function(){Object(d.a)(o.props.counters);o.props.createCounter(o.state.inputData.title,o.state.inputData.value,o.state.inputData.resetValue,o.props.lastId+1),o.state.inputData.title||o.props.setLastId(o.props.lastId+1),o.props.modalProps.onClose&&o.props.modalProps.onClose(),o.props.onClose()},o.saveCounter=function(){for(var e=Object(d.a)(o.props.counters),t=e[o.props.activeCounter],n=t.name,a=o.state.inputData.title||"\u041d\u043e\u0432\u044b\u0439 \u0441\u0447\u0435\u0442\u0447\u0438\u043a";;){var r=!0;if(e.forEach(function(e,t){if(console.log(a,e.name),e.name===a&&t!==o.props.activeCounter){console.log("is queal");var n=(a=e.name).match(/\(([0-9]+)\)$/)||[],i=Number(n[1]);console.log(i),i?(i+=1,a=a.replace(/\(([0-9]+)\)$/,"("+i+")")):a+=" (1)",r=!1}}),r)break}t.name=a,e.find(function(e,n){return t.name===e.name&&n!==o.props.activeCounter})?o.setState({titleInputStatus:"error",inputData:Object(p.a)({},o.state.inputData,{title:n})}):(t.value=o.state.inputData.value||0,t.resetValue=o.state.inputData.resetValue||0,console.log(e),o.props.setCounters(e),o.props.modalProps.onClose&&o.props.modalProps.onClose(),o.props.onClose())},o.state={inputData:{value:o.props.modalProps.value||0,resetValue:o.props.modalProps.resetValue||0,title:o.props.modalProps.name},editing:void 0!==o.props.modalProps.resetValue,titleInputStatus:"default"},o}return Object(U.a)(t,e),Object(D.a)(t,[{key:"filterInputValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(e){case"value":case"resetValue":return(t=Number(t))<0&&(t=0),t>999999999999&&(t=999999999999),t;default:return t}}},{key:"inputNumberOnly",value:function(e){e.target.value=Number(e.target.value.replace(/[^0-9]/g,""))||""}},{key:"render",value:function(){var e=this;return a.a.createElement(q.n,{id:this.props.id,header:a.a.createElement(q.o,{left:!q.k&&a.a.createElement(q.j,{onClick:this.props.onClose},a.a.createElement(Z.a,null)),right:a.a.createElement(q.j,{onClick:function(){e.state.editing?e.saveCounter():e.createCounter()}},q.k?"\u0413\u043e\u0442\u043e\u0432\u043e":a.a.createElement(ne.a,null))},this.state.editing?this.props.modalProps.name:"\u041d\u043e\u0432\u044b\u0439 \u0441\u0447\u0435\u0442\u0447\u0438\u043a"),settlingHeight:80,onClose:this.props.onClose},a.a.createElement(q.i,null,a.a.createElement(q.l,{bottom:"error"===this.state.titleInputStatus?"\u0422\u0430\u043a\u043e\u0439 \u0441\u0447\u0435\u0442\u0447\u0438\u043a \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442":"",status:this.state.titleInputStatus,autoComplete:"off",name:"title",onChange:this.handleInput,top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u0430",defaultValue:this.props.modalProps.name||"",placeholder:""}),a.a.createElement(q.l,{autoComplete:"off",maxLength:"12",name:"value",onChange:this.handleInput,top:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u0430",defaultValue:this.props.modalProps.value||"",placeholder:"0",type:"tel",pattern:"[0-9]*",onInput:this.inputNumberOnly}),a.a.createElement(q.l,{autoComplete:"off",maxLength:"12",name:"resetValue",onChange:this.handleInput,top:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c, \u043a\u043e\u0433\u0434\u0430 \u0434\u043e\u0441\u0442\u0438\u0433\u043d\u0435\u0442",defaultValue:this.props.modalProps.resetValue||"",placeholder:"0",type:"tel",pattern:"[0-9]*",onInput:this.inputNumberOnly}),a.a.createElement(q.b,{size:"xl",level:"primary",onClick:function(){e.state.editing?e.saveCounter():e.createCounter()}},this.state.editing?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c")))}}]),t}(a.a.Component));var Ee=Object(l.b)(function(e){return{counters:e.counter.counters,activeCounter:e.counter.activeCounter,lastId:e.counter.lastId}},function(e){return Object(p.a)({dispatch:e},Object(c.bindActionCreators)({createCounter:R,setCounters:B,setLastId:G},e))})(Oe),je=o(185),we=o.n(je),Se=o(186),ke=o.n(Se),Te=(o(450),o(451),o(452),function(e){function t(e){var o;return Object(H.a)(this,t),(o=Object(L.a)(this,Object(x.a)(t).call(this,e))).copyActiveCounterValue=function(){o.props.counters[o.props.activeCounter]},o.lastAndroidBackAction=0,o.version="1.0.0",o.lastUpdate=0,o}return Object(U.a)(t,e),Object(D.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props,o=t.goBack;(0,t.dispatch)(function(e){m.a.subscribe(function t(o){"VKWebAppUpdateConfig"===o.detail.type&&(m.a.unsubscribe(t),e({type:"SET_COLOR_SCHEME",payload:o.detail.data.scheme}))}),h.a.send("VKWebAppInit",{})}),window.onpopstate=function(){var t=+new Date;t-e.lastAndroidBackAction>500?(e.lastAndroidBackAction=t,o("Android")):window.history.pushState(null,null)}}},{key:"componentDidUpdate",value:function(e,t,o){var n=this.props,a=n.activeView,r=n.activeStory,i=n.activePanel,c=n.scrollPosition,s=n.activeCounter,l=n.counters,u=n.lastIdCounter;if(console.log("Component did update"),e.activeView!==a||e.activePanel!==i||e.activeStory!==r){var p=c[r+"_"+a+"_"+i]||0;window.scroll(0,p)}function d(){return(d=Object(M.a)(I.a.mark(function t(){return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Update..."),l&&l!==e.counters&&localStorage.setItem("counters",JSON.stringify(l||[])),void 0!==s&&s!==e.activeCounter&&localStorage.setItem("activeCounter",s||0),void 0!==u&&u!==e.lastIdCounter&&localStorage.setItem("lastIdCounter",u||0);case 4:case"end":return t.stop()}},t)}))).apply(this,arguments)}!function(){d.apply(this,arguments)}()}},{key:"componentDidMount",value:function(){console.log("Mount main component!");var e,t,o=this.props,n=o.setCounters,a=o.setActiveCounter,r=o.setLoadedCounters;try{e=JSON.parse(localStorage.getItem("counters"))}catch(c){console.error(c)}try{t=Number(localStorage.getItem("activeCounter"))}catch(c){console.error(c)}var i=Number(localStorage.getItem("lastIdCounter"));console.log("[App] localStorage",localStorage.getItem("counters")),console.log("[App] got item counters from local storage first",e),e&&0!==e.length||(e=[{name:"\u041d\u043e\u0432\u044b\u0439 \u0441\u0447\u0435\u0442\u0447\u0438\u043a",id:0,value:0,resetValue:0}]),console.log("[App] got item counters from local storage ",e),n(e||[]),a(t||0),G(i||0),r(!0)}},{key:"render",value:function(){var e=this.props,t=e.goBack,o=e.setStory,n=e.closeModal,r=e.popouts,i=e.activeView,c=e.activeStory,s=e.activePanel,l=e.colorScheme,u=e.activeModals,p=e.panelsHistory,d=e.modalProps,v=void 0===p[i]?[i]:p[i],m=void 0===r[i]?null:r[i],h=void 0===u[i]?null:u[i],f=a.a.createElement(q.p,{activeModal:h},a.a.createElement(Ee,{id:"MODAL_PAGE_MANAGE_COUNTER",onClose:function(){return n()},modalProps:d}));return a.a.createElement(q.e,{isWebView:!0,scheme:l},a.a.createElement(q.g,{activeStory:c,tabbar:a.a.createElement(q.t,null,a.a.createElement(q.u,{onClick:function(){return o("main","activeStory")},selected:"main"===c},a.a.createElement(ke.a,null)),a.a.createElement(q.u,{onClick:function(){return o("counters","counters")},selected:"counters"===c},a.a.createElement(we.a,null)))},a.a.createElement(q.s,{id:"main",activeView:i,popout:m},a.a.createElement(q.w,{id:"main",modal:f,activePanel:s,history:v,onSwipeBack:function(){return t()}},a.a.createElement(fe,{id:"activeCounter",store:this.props.store}))),a.a.createElement(q.s,{id:"counters",activeView:i,popout:m},a.a.createElement(q.w,{id:"counters",modal:f,activePanel:s,history:v,onSwipeBack:function(){return t()}},a.a.createElement(re,{id:"counters"}))),a.a.createElement(q.s,{id:"settings",activeView:i,popout:m},a.a.createElement(q.w,{id:"settings",modal:f,activePanel:s,history:v,onSwipeBack:function(){return t()}},a.a.createElement(Ce,{id:"settings",version:this.version})))))}}]),t}(a.a.Component));var Pe=Object(l.b)(function(e){return{activeView:e.router.activeView,activePanel:e.router.activePanel,activeStory:e.router.activeStory,modalProps:e.router.activeModalProps,panelsHistory:e.router.panelsHistory,activeModals:e.router.activeModals,popouts:e.router.popouts,scrollPosition:e.router.scrollPosition,activeCounter:e.counter.activeCounter,lastIdCounter:e.counter.lastId,colorScheme:e.vkui.colorScheme,counters:e.counter.counters}},function(e){return Object(p.a)({dispatch:e},Object(c.bindActionCreators)({setStory:w,goBack:S,closeModal:A,setCounters:B,setActiveCounter:W,setLastId:G,setLoadedCounters:J},e))})(Te);o.d(t,"store",function(){return Ae});var Ae=Object(c.createStore)(C,Object(O.composeWithDevTools)(Object(c.applyMiddleware)(s.a)));window.onerror=function(e,t,o,n,a){var r='\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u0440\u0438\u0448\u043b\u0438\u0442\u0435 \u0441\u043a\u0440\u0438\u043d\u0448\u043e\u0442 \u043c\u043d\u0435 <a href="https://vk.com/kinock" target="_blank">vk.com/kinock</a> \u0438\u043b\u0438 \u0441\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u043e\u0442\u0447\u0435\u0442 \u0432 \u0431\u0430\u0433-\u0442\u0440\u0435\u043a\u0435\u0440\u0435 <br/><code>'+e+"\n"+t+":"+o+":"+n+"\n"+(a||{}).stack+"</code><br/>"+window.navigator.userAgent;return document.body.innerHTML=r,console.error(a),console.info(r),!1},Ae.dispatch(w("main","activeCounter"));var Ve=document.getElementById("root");j()(Ve),i.a.render(a.a.createElement(l.a,{store:Ae},a.a.createElement(Pe,{store:Ae})),Ve),function(){if("serviceWorker"in navigator){if(new URL("/appcounter",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/appcounter","/service-worker.js");V?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):N(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):N(e)})}}()}},[[236,1,2]]]);
//# sourceMappingURL=main.12f74d7b.chunk.js.map