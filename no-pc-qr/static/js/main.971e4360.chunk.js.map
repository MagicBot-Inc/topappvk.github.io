{"version":3,"sources":["App.js","index.js"],"names":["App","props","changeSelectedPhoto","event","input","target","removeStopScrollWindow","setState","state","defaultState","cropperHeight","files","indexOf","type","setActiveSnack","snacks","errorImageLoading","fr","FileReader","onload","e","setImage","result","onerror","console","log","readAsDataURL","resizeFunction","forceUpdate","move","x","y","newCurrentX","currentPosCroppedX","shiftX","newCurrentY","currentPosCroppedY","shiftY","imgNode","document","getElementById","currentHeightCropper","offsetHeight","currentWidthCropper","offsetWidth","croppedImageStyles","transform","croppedImageOverflowSyles","currentPosImageX","currentPosImageY","stopScrollWindow","window","orientation","lastScrollPos","scrollY","wrapCropperStyles","overflow","body","classList","add","getElementsByTagName","remove","scrollTo","onEndCrop","moveImage","imageStyles","onEndImageMove","scaleImagesMove","originalEvent","currentTarget","newCurrentWidth","newCurrentHeight","cropperImageStyles","cropperStyles","width","height","onEndScaleImagesMove","getQrFromCrop","offsetCropX","getBoundingClientRect","offsetCropY","Math","floor","imageWidth","imageHeight","canvas","createElement","ctx","getContext","img","Image","drawImage","imageData","getImageData","clearRect","putImageData","getQRFromImage","inversionAttempts","src","toDataURL","image","setQrResult","res","qrResult","openThisImage","connect","send","images","wrapCropperContentStyles","needUpdateCenteringCropper","setuppedCropper","activeSnack","currentCroppedX","currentCroppedY","qrDecodedSuccessfull","qrDecodedSnack","qrDecodedError","errorImageLoadingSnack","QrScanner","WORKER_PATH","snack","this","success","onClose","before","fill","innerWidth","innerHeight","maxHeight","minWidth","cropImgNode","imgHeight","maxWidth","subscribe","detail","schemeAttribute","createAttribute","value","data","scheme","attributes","setNamedItem","addEventListener","removeEventListener","scanImage","then","catch","error","activePanel","id","theme","className","style","map","controllerType","i","key","onStart","onMove","onEnd","onTouchStart","startTouch","onClick","wordBreak","marginTop","marginBottom","componentDecorator","href","text","rel","split","a","size","accept","onChange","level","React","Component","ReactDOM","render"],"mappings":"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","file":"static/js/main.971e4360.chunk.js","sourcesContent":["import React from 'react';\n\nimport QrScanner from 'qr-scanner';\nimport connect from '@vkontakte/vk-connect';\n\nimport { Panel, PanelHeader, File, Div, View, Touch, Button, Link, Snackbar, Group } from '@vkontakte/vkui';\n\nimport Linkify from 'react-linkify';\n\n\nimport Icon24Camera from '@vkontakte/icons/dist/24/camera';\nimport Icon24Fullscreen from '@vkontakte/icons/dist/24/fullscreen';\nimport Icon24Qr from '@vkontakte/icons/dist/24/qr';\nimport Icon24Done from '@vkontakte/icons/dist/24/done';\nimport Icon24DoNotDisturb from '@vkontakte/icons/dist/24/do_not_disturb';\n\nimport '@vkontakte/vkui/dist/vkui.css';\nimport './css/main.css';\n\n\nclass App extends React.Component {\n\tconstructor (props) {\n\t\tsuper(props);\n\t\t\n\t\tthis.defaultState = {\n\t\t\timage: '',\n\t\t\tcropperStyles: {},\n\t\t\tcroppedImageStyles: {},\n\t\t\tcropperImageStyles: {},\n\t\t\tcroppedImageOverflowSyles: {},\n\t\t\tcurrentPosCroppedX: 0,\n\t\t\tcurrentPosCroppedY: 0,\n\t\t\tcurrentPosImageX: 0,\n\t\t\tcurrentPosImageY: 0,\n\t\t\tcurrentHeightCropper: 100,\n\t\t\tcurrentWidthCropper: 100,\n\t\t\twrapCropperStyles: {},\n\t\t\twrapCropperContentStyles: {},\n\t\t\tqrResult: \"\",\n\t\t\tneedUpdateCenteringCropper: false,\n\t\t\tsetuppedCropper: false\n\t\t}\n\n\t\tthis.state = {\n\t\t\t...this.defaultState,\n\t\t\tactiveSnack: null\n\t\t}\n\t\t\n\t\tthis.currentCroppedX = this.state.currentPosCroppedX;\n\t\tthis.currentCroppedY = this.state.currentCroppedY;\n\n\t\tthis.currentPosImageX = this.state.currentPosImageX;\n\t\tthis.currentPosImageY = this.state.currentPosImageY;\n\n\t\tthis.currentHeightCropper = this.state.currentHeightCropper;\n\t\tthis.currentWidthCropper = this.state.currentWidthCropper;\n\t\tthis.lastScrollPos = 0;\n\n\t\tthis.snacks = {\n\t\t\tqrDecodedSuccessfull: this.qrDecodedSnack(),\n\t\t\tqrDecodedError: this.qrDecodedSnack(false),\n\t\t\terrorImageLoading: this.errorImageLoadingSnack()\n\t\t}\n\n\t\tQrScanner.WORKER_PATH = 'libs/qr-scanner/qr-scanner-worker.min.js';\n\t}\n\n\tsetImage (src=\"\", readQr=true) {\n\t\tlet img = new Image();\n\t\timg.src = src;\n\t\timg.onload = () => {\n\n\t\t\tthis.setState({\n\t\t\t\timage: src,\n\t\t\t\timageWidth: img.width,\n\t\t\t\timageHeight: img.height\n\t\t\t});\n\t\t}\n\t}\n\n\tchangeSelectedPhoto = (event) => {\n\t\tlet input = event.target;\n\t\tthis.removeStopScrollWindow();\n\t\t\n\t\tthis.setState({\n\t\t\t...this.state,\n\t\t\t...this.defaultState\n\t\t});\n\t\t\n\t\tthis.cropperHeight = 0;\n\n\t\tif (input && input.files && input.files[0]) {\n\t\t\t\n\t\t\tif ([\"image/x-png\", \"image/png\", \"image/jpeg\", \"image/jpg\"].indexOf(input.files[0].type) === -1) {\n\t\t\t\tthis.setActiveSnack(this.snacks.errorImageLoading)\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet fr = new FileReader();\n\t\t\t\n\t\t\tfr.onload = (e) => {\n\t\t\t\tthis.setImage(e.target.result);\n\t\t\t}\n\n\t\t\tfr.onerror = () => {\n\t\t\t\tconsole.log('Не удалось')\n\t\t\t\tthis.setActiveSnack(this.snacks.errorImageLoading);\n\t\t\t}\n\n\t\t\tfr.readAsDataURL(input.files[0]);\n\t\t}\n\t}\n\n\tsetActiveSnack (snack) {\n\t\tthis.setState({\n\t\t\tactiveSnack: snack\n\t\t});\n\t}\n\n\tqrDecodedSnack (success=true) {\n\t\treturn (<Snackbar onClose={() => this.setActiveSnack(null)} before={success ? <Icon24Done fill=\"#16C60C\"/> : <Icon24DoNotDisturb fill=\"#F44336\"/> }>{success ? \"Данные получены\" : \"QR не найден\"}</Snackbar>);\n\t}\n\n\terrorImageLoadingSnack () {\n\t\treturn (<Snackbar onClose={() => {this.setActiveSnack(null)}} before={<Icon24DoNotDisturb fill=\"#F44336\"/>}>Не удалось загрузить изображение</Snackbar>)\n\t}\n\n\n\tcomponentDidUpdate () {\n\t\tlet HEADER_HEIGHT = 0;\n\t\tif (this.state.image) {\n\t\t\tlet imgNode = document.getElementById(\"opacity-image\");\n\t\t\t// console.log(this.state, imgNode.offsetWidth, imgNode.offsetHeight)\n\t\t\t\n\t\t\tif (window.innerWidth >= 510) {\n\t\t\t\tif (imgNode.offsetHeight + HEADER_HEIGHT > window.innerHeight) {\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\timageStyles: {\n\t\t\t\t\t\t\t...this.state.imageStyles,\n\t\t\t\t\t\t\tmaxHeight: window.innerHeight - HEADER_HEIGHT,\n\t\t\t\t\t\t\tminWidth: 'auto'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcroppedImageOverflowSyles: {\n\t\t\t\t\t\t\t...this.state.croppedImageOverflowSyles,\n\t\t\t\t\t\t\tminWidth: 'auto'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tneedUpdateCenteringCropper: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} \n\n\t\t\tlet cropImgNode = document.getElementById(\"crop-image\");\n\t\t\t// (cropImgNode && cropImgNode.offsetWidth !== imgNode.offsetWidth)\n\n\t\t\tif (this.state.needUpdateCenteringCropper || !this.state.setuppedCropper || (cropImgNode && cropImgNode.offsetWidth !== imgNode.offsetWidth)) {\n\t\t\t\t\n\n\t\t\t\tlet imgHeight = this.state.imageHeight*imgNode.offsetWidth/this.state.imageWidth;\n\n\t\t\t\tlet currentPosCroppedX = imgNode.offsetWidth / 2 - this.state.currentWidthCropper / 2;\n\t\t\t\tlet currentPosCroppedY = (imgHeight / 2) - this.state.currentHeightCropper / 2;\n\n\t\t\t\tthis.setState({\n\t\t\t\t\tcurrentPosCroppedX,\n\t\t\t\t\tcurrentPosCroppedY,\n\t\t\t\t\tcroppedImageStyles: {\n\t\t\t\t\t\t...this.state.croppedImageStyles,\n\t\t\t\t\t\ttransform: `translateX(${currentPosCroppedX}px) translateY(${currentPosCroppedY}px)`\n\t\t\t\t\t},\n\t\t\t\t\tcroppedImageOverflowSyles: {\n\t\t\t\t\t\t...this.state.croppedImageOverflowSyles,\n\t\t\t\t\t\ttransform: `translateX(${-(currentPosCroppedX)}px) translateY(${-(currentPosCroppedY)}px)`,\n\t\t\t\t\t\tmaxHeight: imgNode.offsetHeight,\n\t\t\t\t\t\tmaxWidth: imgNode.offsetWidth,\n\t\t\t\t\t\tminWidth: imgNode.offsetWidth\n\t\t\t\t\t},\n\t\t\t\t\tneedUpdateCenteringCropper: false,\n\t\t\t\t\tsetuppedCropper: true\n\t\t\t\t});\n\t\t\t} else if (imgNode && this.cropperHeight !== imgNode.offsetHeight) {\n\t\t\t\tthis.cropperHeight = imgNode.offsetHeight;\n\t\t\t\tthis.setState({\n\t\t\t\t\tcropperStyles: {\n\t\t\t\t\t\t...this.state.cropperStyles,\n\t\t\t\t\t\theight: imgNode.height\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\t\t\t\n\t\t}\n\t}\n\n\tcomponentDidMount () {\n\t\tconnect.send(\"VKWebAppInit\", {});\n\t\t\n\t\tconnect.subscribe(e => {\n\t\t\tswitch (e.detail.type) {\n\t        case 'VKWebAppUpdateConfig':\n\t            let schemeAttribute = document.createAttribute('scheme');\n\t            schemeAttribute.value = e.detail.data.scheme ? e.detail.data.scheme : 'client_light';\n\t            document.body.attributes.setNamedItem(schemeAttribute);\n\t            break;\n\t        default:\n\t            console.log(e.detail.type);\n\t    }\n\t\t});\n\n\t\twindow.addEventListener(\"resize\", this.resizeFunction, false);\n\t}\n\n\tcomponentWillUnmount () {\n\t\twindow.removeEventListener(\"resize\", this.resizeFunction);\n\t}\n\n\tresizeFunction = (e) => {\n\t\tthis.forceUpdate();\n\t}\n\n\n\tmove = (e, x, y) => {\n\t\tlet newCurrentX = this.state.currentPosCroppedX + e.shiftX;\n\t\tlet newCurrentY = this.state.currentPosCroppedY + e.shiftY;\n\t\t\n\t\tif (newCurrentX < 0) newCurrentX = 0;\n\t\tif (newCurrentY < 0) newCurrentY = 0;\n\t\t\n\t\tlet imgNode = document.getElementById(\"opacity-image\");\n\n\t\t// console.log(newCurrentX, this.state.currentWidthCropper, imgNode.offsetWidth);\n\n\t\tif (imgNode && newCurrentY + this.state.currentHeightCropper > imgNode.offsetHeight) {\n\t\t\t\tnewCurrentY = imgNode.offsetHeight - this.state.currentHeightCropper;\n\t\t}\n\t\t\n\t\tif (imgNode && newCurrentX + this.state.currentWidthCropper > imgNode.offsetWidth) {\n\t\t\t\tnewCurrentX = imgNode.offsetWidth - this.state.currentWidthCropper;\n\t\t}\n\n\n\t\tthis.currentPosCroppedX = newCurrentX;\n\t\tthis.currentPosCroppedY = newCurrentY;\n\n\t\tthis.setState({\n\t\t\tcroppedImageStyles: {\n\t\t\t\t...this.state.croppedImageStyles,\n\t\t\t\ttransform: `translateX(${newCurrentX}px) translateY(${newCurrentY}px)`\n\t\t\t},\n\t\t\tcroppedImageOverflowSyles: {\n\t\t\t\t...this.state.croppedImageOverflowSyles,\n\t\t\t\ttransform: `translateX(${-(newCurrentX) + this.state.currentPosImageX}px) translateY(${-(newCurrentY ) + this.state.currentPosImageY}px)`\n\t\t\t}\n\t\t});\n\n\t}\n\n\tstopScrollWindow = () => {\n\t\t\n\t\tif (typeof window.orientation === 'undefined') return;\n\n\t\tthis.lastScrollPos = window.scrollY;\n\n\t\tthis.setState({\n\t\t\twrapCropperStyles: {\n\t\t\t\t...this.state.wrapCropperStyles,\n\t\t\t\toverflow: \"hidden\",\n\t\t\t\ttransform: `translateY(-${window.scrollY}px)`\n\t\t\t}\n\t\t});\n\t\t\n\t\tdocument.body.classList.add(\"no-overflow\");\n\t\tdocument.getElementsByTagName(\"html\")[0].classList.add(\"no-overflow\");\n\t}\n\n\tremoveStopScrollWindow = () => {\n\t\tdocument.body.classList.remove(\"no-overflow\");\n\t\tdocument.getElementsByTagName(\"html\")[0].classList.remove(\"no-overflow\");\n\n\t\twindow.scrollTo(0, this.lastScrollPos);\n\t\tthis.setState({\n\t\t\twrapCropperStyles: {\n\t\t\t\t...this.state.wrapCropperStyles,\n\t\t\t\toverflow: \"auto\",\n\t\t\t\ttransform: \"none\"\n\t\t\t}\n\t\t});\n\t}\n\n\tonEndCrop = () => {\n\t\tthis.setState({\n\t\t\tcurrentPosCroppedX: this.currentPosCroppedX,\n\t\t\tcurrentPosCroppedY: this.currentPosCroppedY\n\t\t});\n\n\t\tthis.removeStopScrollWindow();\n\t}\n\n\tmoveImage = (e) => {\n\t\tlet newCurrentX = this.state.currentPosImageX + e.shiftX;\n\t\tlet newCurrentY = this.state.currentPosImageY + e.shiftY;\n\n\t\tthis.currentPosImageX = newCurrentX;\n\t\tthis.currentPosImageY = newCurrentY;\n\n\t\tthis.setState({\n\t\t\timageStyles: {\n\t\t\t\t...this.state.imageStyles,\n\t\t\t\ttransform: `translateX(${newCurrentX}px) translateY(${newCurrentY}px)`\n\t\t\t},\n\t\t\tcroppedImageOverflowSyles: {\n\t\t\t\t...this.state.croppedImageOverflowSyles,\n\t\t\t\ttransform: `translateX(${newCurrentX - this.state.currentPosCroppedX}px) translateY(${newCurrentY - this.state.currentPosCroppedY}px)`\n\t\t\t}\n\t\t});\n\t}\n\n\tonEndImageMove = () => {\n\t\tthis.setState({\n\t\t\tcurrentPosImageX: this.currentPosImageX,\n\t\t\tcurrentPosImageY: this.currentPosImageY\n\t\t});\n\t}\t\n\n\tscaleImagesMove = (e) => {\n\t\tlet elem = e.originalEvent.currentTarget;\n\t\tlet isRight = true;\n\t\tlet newCurrentWidth = this.state.currentWidthCropper + (isRight ? e.shiftX : -e.shiftX);\n\t\tlet newCurrentHeight = this.state.currentHeightCropper + (isRight ? e.shiftY : -e.shiftY);\n\t\t\n\t\t// console.log(newCurrentWidth, newCurrentHeight, e.shiftX, e.shiftY, isRight, elem.classList.value);\n\n\t\tif (newCurrentWidth < newCurrentHeight) {\n\t\t\tnewCurrentHeight = newCurrentWidth;\n\t\t} else {\n\t\t\tnewCurrentWidth = newCurrentHeight;\n\t\t}\n\n\t\tthis.currentWidthCropper = newCurrentWidth;\n\t\tthis.currentHeightCropper = newCurrentHeight;\n\t\t\n\t\tthis.setState({\n\t\t\tcropperImageStyles: {\n\t\t\t\t...this.state.cropperStyles,\n\t\t\t\twidth: newCurrentWidth,\n\t\t\t\theight: newCurrentHeight\n\t\t\t},\n\t\t\tcroppedImageStyles: {\n\t\t\t\t...this.state.croppedImageStyles,\n\t\t\t\twidth: newCurrentWidth,\n\t\t\t\theight: newCurrentHeight\n\t\t\t}\n\t\t});\n\n\t}\n\n\tonEndScaleImagesMove = (e) => {\n\t\tthis.setState({\n\t\t\tcurrentWidthCropper: this.currentWidthCropper,\n\t\t\tcurrentHeightCropper: this.currentHeightCropper\n\t\t});\n\t\tthis.removeStopScrollWindow();\n\t}\n\n\tgetQrFromCrop = () => {\n\t\tlet imgNode = document.getElementById(\"opacity-image\");\n\t\tlet cropNode = document.getElementById(\"crop\");\n\t\tlet cropCoords = cropNode.getBoundingClientRect();\n\t\t\n\t\tlet offsetCropX = this.state.currentPosCroppedX;\n\t\tlet offsetCropY =\tthis.state.currentPosCroppedY;\n\n\t\tlet x = Math.floor(offsetCropX * this.state.imageWidth / imgNode.offsetWidth);\n\t\tlet y = Math.floor(offsetCropY * this.state.imageHeight / imgNode.offsetHeight);\n\n\t\tlet height = Math.floor(this.state.currentHeightCropper * this.state.imageHeight / imgNode.offsetHeight);\n\t\tlet width = Math.floor(this.state.currentWidthCropper * this.state.imageWidth / imgNode.offsetWidth);\n\n\t\tlet canvas = document.createElement(\"canvas\");\n\t\t\n\t\tcanvas.width = this.state.imageWidth;\n\t\tcanvas.height = this.state.imageHeight;\n\n\t\tlet ctx = canvas.getContext('2d');\n\t\n\n\t\tlet img = new Image();\n\t\timg.onload = () => {\n\n\t\t\tctx.drawImage(img, 0, 0);\n\n\t\t\tlet imageData = ctx.getImageData(x, y, width, height);\n\t\t\tcanvas.height = height;\n\t\t\tcanvas.width = width;\n\t\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\n\t\t\tctx.putImageData(imageData, 0, 0);\n\t\t\timg = new Image();\n\t\t\t\n\t\t\timg.onload = () => {\n\t\t\t\tthis.getQRFromImage(img, {\n\t\t\t\t\tinversionAttempts: \"attemptBoth\"\n\t\t\t\t});\n\t\t\t}\n\n\t\t\timg.src = canvas.toDataURL();\n\t\t}\n\n\t\timg.src = this.state.image;\n\t}\n\n\tgetQRFromImage (image) {\n\t\tQrScanner.scanImage(image)\n    .then(res => {\n    \tthis.setQrResult(res);\n    \tthis.setActiveSnack(this.snacks.qrDecodedSuccessfull);\n    })\n    .catch(error => {\n    \tthis.setQrResult(\"\");\n    \tthis.setActiveSnack(this.snacks.qrDecodedError);\n    });\n\t}\n\n\tsetQrResult = (res) => {\n\t\tthis.setState({\n\t\t\tqrResult: res\n\t\t});\n\t}\n\t\n\topenThisImage = () => {\n\t\tconnect.send(\"VKWebAppShowImages\", {\n\t\t\timages: [this.state.image]\n\t\t});\n\t}\n\n\n\trender () {\n\t\tlet controllers = [\"bottom-right\"];\n\n\t\treturn (\n\t\t\t<View activePanel=\"main\">\n\t\t\t\t<Panel id=\"main\" theme=\"white\" className={!this.state.image ? \"centering-panel\" : \"\"}>\n\t\t\t\t\t<PanelHeader>\n\t\t\t\t\t\tQR без камеры\n\t\t\t\t\t</PanelHeader>\n\t\t\t\t\t{this.state.image && \n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<div className=\"wrap-cropper\" style={this.state.wrapCropperStyles}>\n\t\t\t\t\t\t\t\t<div className=\"wrap-cropper-content\" style={this.state.wrapCropperContentStyles}>\n\t\t\t\t\t\t\t\t\t<div className=\"cropper\" style={this.state.cropperStyles}>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"crop\" id=\"crop\" style={this.state.croppedImageStyles}>\n\t\t\t\t\t\t\t\t\t\t\t\t{controllers.map((controllerType, i) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn (<Touch key={\"touch_\" + i} onStart={this.stopScrollWindow} onMove={this.scaleImagesMove} onEnd={this.onEndScaleImagesMove}>{<div className={\"crop-controller \" + controllerType}></div>}</Touch>);\n\t\t\t\t\t\t\t\t\t\t\t\t})}\n\n\t\t\t\t\t\t\t\t\t\t\t\t<Touch onStart={this.stopScrollWindow} onMove={this.move} onEnd={this.onEndCrop}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"cropped-image\" style={this.state.cropperImageStyles} onTouchStart={this.startTouch}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img id=\"crop-image\" style={this.state.croppedImageOverflowSyles} src={this.state.image}/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</Touch>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t<div className=\"opacity-image\" onClick={this.openThisImage}>\n\t\t\t\t\t\t\t\t\t\t\t<img id=\"opacity-image\" style={this.state.imageStyles} src={this.state.image}/>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<Div>\n\t\t\t\t\t\t\t\t\t\t{this.state.qrResult && <div style={{wordBreak: 'break-all', marginTop: 8, marginBottom: 24}}>\n\t\t\t\t\t\t\t\t\t\t\t<Linkify componentDecorator={(href, text, key) => {\n\t                        return (<Link href={href} key={key} target=\"_blank\" rel=\"noopener noreferrer\">{text}</Link>);\n\t                   }} >{this.state.qrResult.split('\\n').map((a, i) => {return (<span key={\"row_\" + i}><span>{this.state.qrResult}</span><br/></span>)})}</Linkify>\n\t\t\t\t\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t\t\t\t\t{!this.state.qrResult && <div style={{wordBreak: 'break-all', marginTop: 8, marginBottom: 24}}>Уточните область QR кода</div>}\n\t\t\t\t\t\t\t\t\t\t<Button onClick={this.getQrFromCrop} before={<Icon24Qr/>} size=\"xl\" style={{marginBottom: 8}}>Сканировать</Button>\n\t\t\t\t\t\t\t\t\t\t<File accept=\"image/x-png,image/jpeg\" onChange={this.changeSelectedPhoto}  before={<Icon24Camera/>} size=\"xl\" level=\"secondary\">Изменить изображение</File>\n\t\t\t\t\t\t\t\t\t\t{this.state.activeSnack}\n\t\t\t\t\t\t\t\t\t</Div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t}\n\t\t\t\t\t{!this.state.image && <Div>\n\t\t\t\t\t\t<p>Чтобы просканировать QR без камеры, выберите скриншот, где он изображен</p>\n\t\t\t\t\t\t<File accept=\"image/x-png,image/jpeg\" onChange={this.changeSelectedPhoto} before={<Icon24Camera/>} size=\"l\">Выбрать скриншот</File>\n\t\t\t\t\t\t{this.state.activeSnack}\n\t\t\t\t\t</Div>}\n\t\t\t\t</Panel>\n\t\t\t</View>\n\t\t);\n\t}\n}\n\nexport default App;\n\n","import 'core-js/features/map';\nimport 'core-js/features/set';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport connect from '@vkontakte/vk-connect';\nimport App from './App';\n// import registerServiceWorker from './sw';\n\n// Init VK  Mini App\nconnect.send('VKWebAppInit');\n\n// Если вы хотите, чтобы ваше веб-приложение работало в оффлайне и загружалось быстрее,\n// расскомментируйте строку с registerServiceWorker();\n// Но не забывайте, что на данный момент у технологии есть достаточно подводных камней\n// Подробнее про сервис воркеры можно почитать тут — https://vk.cc/8MHpmT\n// registerServiceWorker();\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}