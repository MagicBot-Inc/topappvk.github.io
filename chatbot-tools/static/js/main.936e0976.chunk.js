(this["webpackJsonpchatbot-tools"]=this["webpackJsonpchatbot-tools"]||[]).push([[0],{159:function(e,t,n){e.exports=n(251)},249:function(e,t,n){},250:function(e,t,n){},251:function(e,t,n){"use strict";n.r(t);n(160),n(186),n(188),n(189),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(200),n(201),n(202),n(203),n(204),n(205),n(206),n(207),n(208),n(209),n(211),n(212),n(213),n(214),n(215),n(216),n(217),n(218),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228);var a=n(0),r=n.n(a),s=n(41),o=n.n(s),i=n(5),c=n.n(i),l=n(17),u=n.n(l),p=n(51),h=n(34),d=n(12),m=n(13),v=n(14),f=n(15),b=(n(237),n(3)),E=(n(248),n(48)),k=n.n(E),y=(n(249),function(e){var t=e.onChange,n=e.onClose,a=e.closeIcon,s=e.key,o=e.title,i=e.setSearch,l=window.location.search,u="desktop_web"===(l=new URLSearchParams(l)).get("vk_platform");return console.log(l.get("vk_platform")),r.a.createElement(b.l,{key:s,left:r.a.createElement(b.m,{onClick:function(e){n?n(e):(c.a.send("VKWebAppClose",{status:"success",payload:{}}),window.history.back())}},a||r.a.createElement(k.a,null))},i?r.a.createElement(b.p,{onChange:t,className:u?"":"margins"}):o||"ChatBot Tools")}),g=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).selectCountry=function(e){"selectCountry"===a.props.activeHash?a.props.sendResponse({country_id:e,country_title:a.state.countries.find((function(t){return t.id===e})).title}):a.setState({selectedCountryId:e},(function(){a.loadCities()}))},a.selectCity=function(){var e=Object(h.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.props.sendResponse({city_id:t.id,city_title:t.title,country_id:a.state.selectedCountryId,country_title:a.state.countries.find((function(e){return e.id===a.state.selectedCountryId})).title}),a.clearCities();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.clearCities=function(){a.setState({cities:[],selectedCountryId:0,countryName:""})},a.changeSearchQuery=function(e){var t=e.target.value;a.state.selectedCountryId?a.loadCities(t):a.setState({countryName:String(t).toLocaleLowerCase()})},a.state={countries:[],cities:[],selectedCountryId:0,loadedCountries:!1,loadedCities:!1,countryName:""},a}return Object(m.a)(n,[{key:"componentDidMount",value:function(){this.props.userToken;this.state.countries.length||this.loadCountries()}},{key:"loadCountries",value:function(){var e=Object(h.a)(u.a.mark((function e(){var t,n,a=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:"",this.setState({loadCountries:!1}),e.next=4,this.props.vkApi("database.getCountries",{need_all:1,q:t,count:1e3});case 4:n=e.sent,this.setState({loadedCountries:!0,countries:n.items});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadCities",value:function(){var e=Object(h.a)(u.a.mark((function e(){var t,n,a=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:"",this.setState({loadedCities:!1}),e.next=4,this.props.vkApi("database.getCities",{country_id:this.state.selectedCountryId,q:t});case 4:n=e.sent,this.setState({loadedCities:!0,cities:n.items});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderCities",value:function(){var e=this,t=this.state,n=t.cities,a=t.loadedCities;return n.length||a?n.length?r.a.createElement("div",null,r.a.createElement(b.g,{header:r.a.createElement(b.h,{mode:"secondary",aside:r.a.createElement(b.i,{onClick:this.clearCities},"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0442\u0440\u0430\u043d\u0443")},"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0433\u043e\u0440\u043e\u0434")},r.a.createElement(b.j,null,n.map((function(t){return r.a.createElement(b.d,{onClick:function(){return e.selectCity(t)},key:"city"+t.id},t.title)}))))):r.a.createElement(b.e,null,"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430"):r.a.createElement(b.n,{size:"l"})}},{key:"render",value:function(){var e=this,t=this.state,n=t.countries,a=t.loadedCountries,s=t.countryName,o=t.selectedCountryId;return r.a.createElement(b.k,{id:this.props.id},r.a.createElement(y,{setSearch:!0,key:o?"country":"city",onChange:this.changeSearchQuery}),n.length||a?n.length?o?this.renderCities():r.a.createElement(b.g,{header:r.a.createElement(b.h,{mode:"secondary"},"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0443")},r.a.createElement(b.j,null,n.filter((function(e){return String(e.title).toLocaleLowerCase().match(s)})).map((function(t){return r.a.createElement(b.d,{onClick:function(){return e.selectCountry(t.id)},key:"country"+t.id},t.title)})))):r.a.createElement(b.e,null,"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430"):r.a.createElement(b.n,{size:"l"}))}}]),n}(r.a.Component),C=n(101),w=n.n(C),A=function(e){var t=e.onRequestToken,n=e.id,a=e.activeHash;return r.a.createElement(b.k,{id:n,centered:!0,header:!1},r.a.createElement(y,{title:"ChatBot Tools"}),r.a.createElement(b.o,{icon:r.a.createElement(w.a,null),action:r.a.createElement(b.b,{size:"xl",onClick:t},"\u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c")},"\u0427\u0442\u043e\u0431\u044b ",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";switch(e){case"selectCity":return"\u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0433\u043e\u0440\u043e\u0434";default:return"\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u043c"}}(a),", \u0432\u0430\u043c \u043d\u0443\u0436\u043d\u043e \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043e\u0431\u0449\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0412\u0430\u0441."))},j=function(e){var t=e.id;return r.a.createElement(b.k,{id:t,centered:!0,header:!1},r.a.createElement(y,{title:"ChatBot Tools"}),r.a.createElement(b.e,{className:"align-center"},"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430. ",r.a.createElement("br",null),"\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043c\u0435\u0442\u043e\u0434\u0430."))},O=n(102),P=n.n(O),_=n(49),R=n.n(_),V=function(e){var t=e.id;return r.a.createElement(b.k,{id:t,centered:!0},r.a.createElement(y,{title:"\u041f\u0440\u0438\u0432\u0435\u0442!"}),r.a.createElement(b.o,{icon:r.a.createElement(R.a,null),header:"ChatBot Tools",action:r.a.createElement(b.b,{size:"xl",onClick:function(){c.a.send("VKWebAppAddToCommunity",{})},before:r.a.createElement(P.a,null)},"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0432 \u0441\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u043e")},"\u042d\u0442\u043e \u043d\u043e\u0432\u044b\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0434\u043b\u044f \u0412\u0430\u0448\u0438\u0445 ",r.a.createElement("br",null)," \u0447\u0430\u0442-\u0431\u043e\u0442\u043e\u0432 \u0412\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u0435."))},H=n(103),W=n.n(H),x=function(e){var t=e.hashParams,n=e.requests,a=e.onClick,s=e.actionText,o=e.action,i=e.icon,c=t.get("bot_name")||"\u0427\u0430\u0442-\u0431\u043e\u0442",l=t.get("bot_photo")||"";return r.a.createElement(b.c,null,r.a.createElement(b.o,{icon:l?r.a.createElement(b.a,{size:82,src:l}):i||r.a.createElement(W.a,null),header:c,action:o||r.a.createElement(b.b,{size:"xl",onClick:a},s||"\u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c")},n))},K=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).getEmail=function(){c.a.supports("VKWebAppGetEmail")?c.a.send("VKWebAppGetEmail",{}).then((function(t){e.props.sendResponse({email:t.email})})).catch((function(t){e.props.sendError("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c Email",t)})):e.props.sendError("\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 Email \u043d\u0430 \u044d\u0442\u043e\u043c \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0435 \u043d\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e",{error_code:"not_supports"})},e}return Object(m.a)(n,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.hashParams;return r.a.createElement(b.k,{id:t,centered:!0},r.a.createElement(y,null),r.a.createElement(x,{onClick:this.getEmail,hashParams:n,requests:"\u0417\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0412\u0430\u0448\u0435\u043c\u0443 Email \u0430\u0434\u0440\u0435\u0441\u0443"}))}}]),n}(r.a.Component),q=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).getPhoneNumber=function(){c.a.supports("VKWebAppGetPhoneNumber")?c.a.send("VKWebAppGetPhoneNumber",{}).then((function(t){e.props.sendResponse({phone_number:t.phone_number})})).catch((function(t){e.props.sendError("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430",t)})):e.props.sendError("\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043d\u043e\u043c\u0435\u0440\u0430 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430 \u043d\u0430 \u044d\u0442\u043e\u043c \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0435 \u043d\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e",{error_code:"not_supports"})},e}return Object(m.a)(n,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.hashParams;return r.a.createElement(b.k,{id:t,centered:!0},r.a.createElement(y,null),r.a.createElement(x,{onClick:this.getPhoneNumber,hashParams:n,requests:"\u0417\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0412\u0430\u0448\u0435\u043c\u0443 \u043d\u043e\u043c\u0435\u0440\u0443 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430"}))}}]),n}(r.a.Component),S=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).joinGroup=function(){var t=e.props.hashParams;c.a.supports("VKWebAppJoinGroup")?c.a.send("VKWebAppJoinGroup",{group_id:Number(t.get("group_id"))}).then((function(t){e.props.sendResponse(t)})).catch((function(t){e.props.sendError("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0432\u0441\u0442\u0443\u043f\u0438\u0442\u044c \u0432 \u0441\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u043e",t)})):e.props.sendError("\u0412\u0441\u0442\u0443\u043f\u043b\u0435\u043d\u0438\u0435 \u0432 \u0441\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u043e \u043d\u0430 \u044d\u0442\u043e\u043c \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0435 \u043d\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e",{error_code:"not_supports"})},e}return Object(m.a)(n,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.hashParams;return r.a.createElement(b.k,{id:t,centered:!0},r.a.createElement(y,null),r.a.createElement(x,{onClick:this.joinGroup,hashParams:n,requests:"\u041f\u0440\u0435\u0434\u043b\u0430\u0433\u0430\u0435\u0442 \u0432\u0441\u0442\u0443\u043f\u0438\u0442\u044c \u0432 \u0441\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u043e",actionText:"\u0412\u0441\u0442\u0443\u043f\u0438\u0442\u044c"}))}}]),n}(r.a.Component),T=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).subscribeGroupMessages=function(){var t=e.props.hashParams;c.a.send("VKWebAppAllowMessagesFromGroup",{group_id:Number(t.get("group_id")),key:t.get("key")}).then((function(t){e.props.sendResponse(t)}))},e}return Object(m.a)(n,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.hashParams;return r.a.createElement(b.k,{id:t,centered:!0},r.a.createElement(y,null),r.a.createElement(x,{onClick:this.subscribeGroupMessages,hashParams:n,requests:"\u0417\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0443 \u043d\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0441\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u0430",actionText:"\u041f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f"}))}}]),n}(r.a.Component),G=n(105),N=n(104),I=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).routeDialog=function(){var t,n={},a=Object(N.a)(e.props.hashParams);try{for(a.s();!(t=a.n()).done;){var r=Object(G.a)(t.value,2),s=r[0],o=r[1];n[s]=o}}catch(i){a.e(i)}finally{a.f()}return e.props.sendResponse(n),!0},e}return Object(m.a)(n,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.hashParams;return r.a.createElement(b.k,{id:t,centered:!0},r.a.createElement(y,null),r.a.createElement(b.f,null,r.a.createElement(x,{hashParams:n,requests:"\u041f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043a \u0434\u0438\u0430\u043b\u043e\u0433\u0443 \u0441 \u0447\u0430\u0442-\u0431\u043e\u0442\u043e\u043c",icon:r.a.createElement(R.a,null),action:r.a.createElement(b.i,{href:"https://vk.com/im?sel=-"+n.get("bot_id"),onClick:this.routeDialog,target:"_blank"},r.a.createElement(b.b,{size:"xl"},"\u0411\u044b\u0441\u0442\u0440\u044b\u0439 \u0434\u0438\u0430\u043b\u043e\u0433"))})))}}]),n}(r.a.Component),M=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"componentWillMount",value:function(){var e=this;c.a.supports("VKWebAppGetClientVersion")?c.a.send("VKWebAppGetClientVersion",{}).then((function(t){e.props.sendResponse(t)})).catch((function(t){e.props.sendError("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u0444\u043d\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438",t)})):this.props.sendError("\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0432\u0435\u0440\u0441\u0438\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043d\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u043d\u0430 \u044d\u0442\u043e\u043c \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0435",{error_code:"not_supports"})}},{key:"render",value:function(){var e=this.props,t=e.id;e.hashParams;return r.a.createElement(b.k,{id:t,centered:!0},r.a.createElement(y,null),"\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0432\u0435\u0440\u0441\u0438\u044e ...")}}]),n}(r.a.Component),D=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"componentWillMount",value:function(){var e=this;c.a.supports("VKWebAppOpenCodeReader")?c.a.send("VKWebAppOpenCodeReader",{}).then((function(t){e.props.sendResponse(t)})).catch((function(t){e.props.sendError("QR \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c",t)})):this.props.sendError("\u0427\u0442\u0435\u043d\u0438\u0435 QR \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f",{error_code:"not_supports"})}},{key:"render",value:function(){var e=this.props,t=e.id;e.hashParams;return r.a.createElement(b.k,{id:t,centered:!0},r.a.createElement(y,null),"\u041e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u043c \u0441\u043a\u0430\u043d\u0435\u0440 ...")}}]),n}(r.a.Component),F=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"componentWillMount",value:function(){var e=this,t=this.props.hashParams;c.a.supports("VKWebAppDownloadFile")?c.a.send("VKWebAppDownloadFile",{url:t.get("file_url"),filename:t.get("file_name")}).then((function(t){e.props.sendResponse(t)})).catch((function(t){e.props.sendError("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u0444\u0430\u0439\u043b",t)})):this.props.sendError("\u0421\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u0430 \u043d\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u043d\u0430 \u044d\u0442\u043e\u043c \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0435",{error_code:"not_supports"})}},{key:"render",value:function(){var e=this.props.id;return r.a.createElement(b.k,{id:e,centered:!0},r.a.createElement(y,null),"\u0424\u0430\u0439\u043b \u0441\u043a\u0430\u0447\u0438\u0432\u0430\u0435\u0442\u0441\u044f ...")}}]),n}(r.a.Component),L=(n(250),function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(e){var a;Object(d.a)(this,n),(a=t.call(this,e)).sendResponse=Object(h.a)(u.a.mark((function e(){var t,n,r,s,o=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:{},n=!(o.length>1&&void 0!==o[1])||o[1],(r=Object(p.a)({method:a.state.activeHash,hash:window.location.hash.replace("#","")},t)).error||(r.success=!0),!(s=a.hashParams.get("bot_id"))){e.next=8;break}return e.next=8,c.a.send("VKWebAppSendPayload",{group_id:Number(s),payload:r});case 8:if(!n){e.next=16;break}if("desktop_web"!==a.queryParams.get("vk_platform")&&"mobile_web"!==a.queryParams.get("vk_platform")){e.next=13;break}window.history.back(),e.next=16;break;case 13:return c.a.send("VKWebAppSetLocation",{location:window.location.hash+"&"+(new Date).getTime()}),e.next=16,c.a.send("VKWebAppClose",{status:"success",payload:r});case 16:case"end":return e.stop()}}),e)}))),a.sendError=Object(h.a)(u.a.mark((function e(){var t,n,r,s=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:"",n=s.length>1&&void 0!==s[1]?s[1]:{},r=!(s.length>2&&void 0!==s[2])||s[2],e.abrupt("return",a.sendResponse(Object(p.a)({},n,{error:!0,error_message:t}),r));case 4:case"end":return e.stop()}}),e)}))),a.requestToken=Object(h.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.a.send("VKWebAppGetAuthToken",{app_id:7388296,scope:"status"}).then((function(e){a.setState({userToken:e.access_token,activePanel:"gettingAuth"===a.state.activePanel?a.state.activeHash:a.state.activePanel})}));case 1:case"end":return e.stop()}}),e)}))),a.makeApiCall=function(){var e=Object(h.a)(u.a.mark((function e(t){var n,r,s=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},r=a.state.userToken,e.abrupt("return",c.a.send("VKWebAppCallAPIMethod",{method:t,request_id:String((new Date).getTime()),params:Object(p.a)({v:"5.103",access_token:r},n)}).then((function(e){return e.response})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.queryString=window.location.search,a.queryParams=new URLSearchParams(a.queryString),console.log(a.queryString,a.queryParams);var r=window.location.hash.replace(/^#/,"?");console.log(r);var s="";r.replace("?","").match(/^(\d+)/)&&(r="?method=routeDialog&bot_id=".concat(r.replace("?",""))),console.log(r,"hashParams 2"),r=new URLSearchParams(r),a.hashParams=r,s=r.get("method"),console.log(s),-1===["selectCity","selectCountry","getEmail","getPhoneNumber","joinGroup","allowMessagesFromGroup","routeDialog","getAppVersion","readQRCode","downloadFile"].indexOf(s)&&(s=s&&s.length?"notFound":"hello");var o="gettingAuth",i="status"===a.queryParams.get("vk_access_token_settings");return(i||-1===["selectCountry","selectCity"].indexOf(s))&&(o=s),console.log(o,s,i),a.state={userToken:"",activePanel:o,activeHash:s,popout:null,hashParams:r},i&&a.requestToken(),a.wasClosed=!1,c.a.subscribe((function(e){"VKWebAppLocationChanged"===e.type||"VKWebAppViewRestore"===e.type&&a.wasClosed?window.location.reload():"VKWebAppViewHide"===e.type&&(a.wasClosed=!0)})),a}return Object(m.a)(n,[{key:"componentDidMount",value:function(){"notFound"===this.state.activeHash&&this.sendError("\u041c\u0435\u0442\u043e\u0434 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d",{},!1)}},{key:"render",value:function(){var e=this.state.activePanel,t=this.state,n=t.popout,a=t.userToken,s=t.hashParams,o=t.activeHash;return"notFound"===e||"gettingAuth"===e||"hello"===e||a||-1===["selectCountry","selectCity"].indexOf(o)||(e="loading"),"selectCountry"===e&&(e="selectCity"),"loading"===e?r.a.createElement(b.n,{size:"l"}):r.a.createElement(b.q,{activePanel:e,popout:n},r.a.createElement(V,{id:"hello"}),r.a.createElement(j,{id:"notFound"}),r.a.createElement(K,{id:"getEmail",activeHash:this.state.activeHash,sendResponse:this.sendResponse,vkApi:this.makeApiCall,hashParams:s}),r.a.createElement(D,{id:"readQRCode",activeHash:this.state.activeHash,sendError:this.sendError,sendResponse:this.sendResponse,vkApi:this.makeApiCall,hashParams:s}),r.a.createElement(F,{id:"downloadFile",activeHash:this.state.activeHash,sendError:this.sendError,sendResponse:this.sendResponse,vkApi:this.makeApiCall,hashParams:s}),r.a.createElement(I,{id:"routeDialog",activeHash:this.state.activeHash,sendError:this.sendError,sendResponse:this.sendResponse,vkApi:this.makeApiCall,hashParams:s}),r.a.createElement(S,{id:"joinGroup",activeHash:this.state.activeHash,sendError:this.sendError,sendResponse:this.sendResponse,vkApi:this.makeApiCall,hashParams:s}),r.a.createElement(M,{id:"getAppVersion",activeHash:this.state.activeHash,sendError:this.sendError,sendResponse:this.sendResponse,vkApi:this.makeApiCall,hashParams:s}),r.a.createElement(T,{id:"allowMessagesFromGroup",activeHash:this.state.activeHash,sendError:this.sendError,sendResponse:this.sendResponse,vkApi:this.makeApiCall,hashParams:s}),r.a.createElement(q,{id:"getPhoneNumber",activeHash:this.state.activeHash,sendError:this.sendError,sendResponse:this.sendResponse,vkApi:this.makeApiCall,hashParams:s}),r.a.createElement(g,{id:"selectCity",activeHash:this.state.activeHash,sendError:this.sendError,sendResponse:this.sendResponse,userToken:a,vkApi:this.makeApiCall,hashParams:s}),r.a.createElement(A,{id:"gettingAuth",activeHash:this.state.activeHash,sendError:this.sendError,onRequestToken:this.requestToken}))}}]),n}(r.a.Component));c.a.send("VKWebAppInit"),c.a.subscribe(console.log),o.a.render(r.a.createElement(L,null),document.getElementById("root")),Promise.all([n.e(3),n.e(4)]).then(n.bind(null,255)).then((function(e){})),window.onerror=function(e,t,n,a,r){var s="<br/><pre>"+e+"\n"+t+":"+n+":"+a+"\n"+(r||{}).stack+"</pre><br/>"+window.navigator.userAgent;return document.body.innerHTML=s,console.error(r),console.info(s),!1}}},[[159,1,2]]]);
//# sourceMappingURL=main.936e0976.chunk.js.map